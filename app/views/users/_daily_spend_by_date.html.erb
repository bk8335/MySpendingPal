<h3>Spending by date</h3>
<p>Your average spend to date is <%= @user.primary_currency %><%= @user.average_spend_to_date(current_user).round(2) %></p>
<p>Total spend to date: <%=@user.primary_currency %><%= @user.daily_spending_total_to_now(current_user) %></p>
<p>Days passed: <%= Date.current.day %></p>
<% date = DateTime.now.end_of_month.to_date %>

<% loop do %>
<div style="overflow-x:auto;">
<table class="daily-entries-table">
  <tr>
  <th class="daily-spend-by-date"><%= date.strftime("%e %B") %></th>
  <th><%= @currency %><%= @user.format_currency(@user.spend_on_date(current_user, date))%></th>
  <th><%=link_to "Add entry", new_user_daily_expense_path(current_user, date), class: "btn btn-default"%></th>
  <th></th>
  <th></th>
  </tr>
  <% items_in_day = @user.daily_spend_detail(current_user, date) %>
  <% items_in_day.each do |item| %>
    <tr>
      <td><%= @currency %><%= @user.format_currency(item.amount) %></td>
      <td><%= item.name %></td>
      <td><%= item.category %></td>
      <td><%= link_to "Edit entry", edit_user_daily_expense_path(current_user, item) %></td>
      <td><%= link_to "Delete", item, method: :delete %></td>
    </tr>
  <% end %>
  <% date -= 1.day %>
  <% break if (date.month == (DateTime.now.month - 1)) || (date.month == 12 && (DateTime.now.month == 1)) %>
</table>
</div>
<br>
<% end %>
